import pandas as pd
import numpy as np

data = {
    "customer_id": [101,102,101,103,104,105],
    "age": [25, np.nan, 30, 22, 100, 27],
    "income": [50000, 60000, 55000, 48000, 1000000, 52000],
    "city": ["Toronto","Toronto","Montreal","Vancouver","Toronto","Montreal"],
    "purchase": [200, 250, 150, 300, 5000, 180]
}

df = pd.DataFrame(data)